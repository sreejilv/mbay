<!doctype html>
<html class="no-js" lang="ar" dir="ltr">

<head>
    <meta charset="utf-8">
    <base href="{{BASE_URL}}" />
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Mbay Online Shopping</title>
    <meta name="robots" content="noindex, follow" />
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, user-scalable=no" />
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="assets/shop/images/favicon.png">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.css" rel="stylesheet"/>

    <!-- All CSS is here
	============================================ -->

    <link rel="stylesheet" href="assets/shop/css/vendor/bootstrap.min.css">
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.rtl.min.css"> -->
    <link rel="stylesheet" href="assets/shop/css/vendor/signericafat.css">
    <link rel="stylesheet" href="assets/shop/css/vendor/cerebrisans.css">
    <link rel="stylesheet" href="assets/shop/css/vendor/simple-line-icons.css">
    <link rel="stylesheet" href="assets/shop/css/vendor/elegant.css">
    <link rel="stylesheet" href="assets/shop/css/vendor/linear-icon.css">

    <link rel="stylesheet" href="assets/shop/css/plugins/animate.css">

    <link rel="stylesheet" href="assets/shop/css/style.css">
    <!-- <link rel="stylesheet" href="assets/shop/css/style_rtl.css"> -->

    <!-- Custom CSS -->
    <link rel="stylesheet" href="assets/css/custom_style.css">
    <!-- <link rel="stylesheet" href="assets/shop/css/custom_style_rtl.css"> -->

</head>
<div id="js_messages" style="display: none;"> 
    <span id="first_name_req_js">{{lang('first_name_req_js')}}</span>   
    <span id="last_name_req_js">{{lang('last_name_req_js')}}</span>   
    <span id="email_req_js">{{lang('email_req_js')}}</span>   
    <span id="phone_number_req_js">{{lang('phone_number_req_js')}}</span>   
    <span id="address_1_req_js">{{lang('address_1_req_js')}}</span>   
    <span id="city_req_js">{{lang('city_req_js')}}</span>   
    <span id="country_req_js">{{lang('country_req_js')}}</span>   
    <span id="zip_code_req_js">{{lang('zip_code_req_js')}}</span>   
    <span id="current_password_req_js">{{lang('current_password_req_js')}}</span>   
    <span id="new_password_req_js">{{lang('new_password_req_js')}}</span>   
    <span id="confirm_password_req_js">{{lang('confirm_password_req_js')}}</span>   
    <span id="password_mismatch_js">{{lang('password_mismatch_js')}}</span>   
    
</div>

<body>

    <div class="main-wrapper bg-gray-9">

        <!-- HEADER -->
        {% include('shop/layout/header.twig')%}
        {%include('admin/layout/notification.twig')%}
        <!-- END HEADER -->

        <!-- MOBILE MENU -->
        <div class="mobile-header-active mobile-header-wrapper-style">
            <div class="clickalbe-sidebar-wrap">
                <a class="sidebar-close"><i class="icon_close"></i></a>
                <div class="mobile-header-content-area">

                    <div class="mobile-menu-wrap mobile-header-padding-border-2">
                        <!-- mobile menu start -->
                        <nav>
                            <ul class="mobile-menu">
                                <li><a href="#">Home</a></li>
                                <li><a href="#">About</a></li>
                                <li class="menu-item-has-children"><a href="#">Shop</a>
                                    <ul class="dropdown">
                                        <li><a href="#">Smartphone </a></li>
                                    </ul>
                                </li>
                                <li><a href="#">Contact us</a></li>
                            </ul>
                        </nav>
                        <!-- mobile menu end -->
                    </div>
                    <div class="mobile-social-icon">
                        <a class="facebook" href="#"><i class="icon-social-facebook"></i></a>
                        <a class="instagram" href="#"><i class="icon-social-instagram"></i></a>
                    </div>
                </div>
            </div>
        </div>
        <!-- END MOBILE MENU -->


        <!-- MOBILE VIEW SEARCH AREA -->
        <div class="mobile-view-search p-3 pt-0 d-block d-md-block d-lg-block d-xl-none">
            <div class="input-group input-group-sm">
                <input type="text" class="form-control shadow-none" placeholder="What are you looking for?"
                    aria-label="Recipient's username" aria-describedby="button-addon2">
                <button class="btn btn-outline-secondary" type="button" id="button-addon2"><i
                        class="icon-magnifier"></i></button>
            </div>
        </div>
        <!-- END MOBILE VIEW SEARCH AREA -->

        <!-- Breadcrumb-area -->
        <div class="breadcrumb-area bg-gray">
            <div class="container">
                <div class="breadcrumb-content text-center">
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li class="active">About us</li>
                    </ul>
                </div>
            </div>
        </div>
        <!-- End Breadcrumb-area -->


        <!-- ACCOUNT -->
        <section class="account-area bg-white pt-120 pb-120">
            <div class="container">
                <div class="row">
                    <div class="col-xl-3 col-lg-12">
                        <div class="aside-menu">
                            <div class="nav nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
                                <button class="nav-link {% if active == 1 %} active {% endif %}"  id="v-pills-dashboard-tab" data-bs-toggle="pill" data-bs-target="#v-pills-dashboard" type="button" role="tab" aria-controls="v-pills-dashboard" aria-selected="false">
                                    <i class="icon-equalizer rotate-90"></i>Dashboard
                                </button>
                                <button class="nav-link {% if active == 2 %} active {% endif %}" id="v-pills-orders-tab" data-bs-toggle="pill" data-bs-target="#v-pills-orders" type="button" role="tab" aria-controls="v-pills-orders" aria-selected="false">
                                    <i class="icon-handbag"></i>Orders
                                </button>
                                <button class="nav-link {% if active == 3 %} active {% endif %}" id="v-pills-address-tab" data-bs-toggle="pill" data-bs-target="#v-pills-address" type="button" role="tab" aria-controls="v-pills-address" aria-selected="false">
                                    <i class="icon-home"></i>My Address
                                </button>

                                <button class="nav-link {% if active == 4 %} active {% endif %}" id="v-pills-account-tab" data-bs-toggle="pill" data-bs-target="#v-pills-account" type="button" role="tab" aria-controls="v-pills-account" aria-selected="false">
                                    <i class="icon-user"></i>Account Details
                                </button>
                                <button class="nav-link {% if active == 5 %} active {% endif %} " id="v-pills-password-tab" data-bs-toggle="pill" data-bs-target="#v-pills-password" type="button" role="tab" aria-controls="v-pills-password" aria-selected="true">
                                    <i class="icon-lock"></i>Change Password
                                </button>
                                <a href="#logout" class="nav-link">
                                    <i class="icon-logout"></i>Logout
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-9">
                        <div class="tab-content" id="v-pills-tabContent">
                            <div class="tab-pane fade  {% if active == 1 %} show active {% endif %}" id="v-pills-dashboard" role="tabpanel" aria-labelledby="v-pills-dashboard-tab" tabindex="0">
                                <!--dashboard-->
                                <div class="card">
                                    <div class="card-header">
                                        <h3 class="mb-0">Hello &nbsp;{{user_name}}</h3>
                                    </div>
                                    <div class="card-body">
                                        <p class="card-text">
                                            From your account dashboard. you can easily check & view your recent orders,
                                            manage your shipping and billing addresses and edit your password and account details.
                                        </p>
                                    </div>
                                </div>
                                <!--end dashboard-->
                            </div>
                            <div class="tab-pane fade {% if active == 2 %} show active {% endif %}" id="v-pills-orders" role="tabpanel" aria-labelledby="v-pills-orders-tab" tabindex="0">
                                <!--orders-->
                                <div class="card orders">
                                    <div class="card-header">
                                        <h3 class="mb-0">Your Orders</h3>
                                    </div>
                                    <div class="card-body">
                                        <div class="table-responsive text-nowrap">
                                            <table class="table mb-0">
                                                <thead>
                                                    <tr>
                                                        <th>Order</th>
                                                        <th>Date</th>
                                                        <th>Status</th>
                                                        <th>Total</th>
                                                        <th>Bill</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    {% for order in user_orders %}
                                                    <tr>
                                                        <td>#MBOO{{order.order_id}}</td>
                                                        <td>{{order.order_date}}</td>
                                                        <td>{{order.order_status}}</td>
                                                        <td>{{order.total_amount}} for&nbsp;{{order.product_count}} item</td>
                                                        <td><a target="_blank" href="account/user-invoice/{{order.order_id}}" class="btn-small d-block text-primary">Download</a></td>
                                                    </tr>
                                                    {% endfor %}
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                </div>
                                
                                <!--end orders-->
                            </div>







                            <div class="tab-pane fade  {% if active == 3 %} show active {% endif %}" id="v-pills-address" role="tabpanel3" aria-labelledby="v-pills-address-tab" tabindex="0">
                                <!--address-->
                                <div class="card address">
                                    <div class="card-header">
                                        <h3 class="mb-0">Shipping Address</h3>
                                    </div>
                                    <div class="card-body">
                                        <span class="badge text-bg-light">Home</span>
                                        <address>
                                            {% for add in address %}
                                            <p>{{add.address_1}}<br>
                                            {{add.address_2}}<br>
                                            {{add.city}}<br>
                                            {{add.country_id}}<br>
                                            {{add.zip_code}}</p>
                                            <a href="{{BASE_URL}}account/3/edit/{{add.id}}" class="btn-small text-primary acct-address-edit mb-2 d-inline-block">Edit</a>
                                            {% endfor %}
                                        </address>
                                    </div>
                                </div>
                                <!--end address-->

                                {{ form_open('', 'class="address_form" id="address_form" name="address_form"')|raw }}
                                <div class="card-body p-4"> 
                                    <div class="card-header">
                                        <h4 class="panel-title">
                                            <span class="text-bold">
                                                {% if edit_flag %}
                                                    {{lang('update_address')}}
                                                {% else %}
                                                    {{lang('add_address')}}
                                                {% endif %}
                                            </span>
                                        </h4>
                                    </div>
                                    <br>
                                    <div class="row" class="form-control">
                                        <div class="col-lg-12 ms-lg-auto">
                                            <div class="mt-4 mt-lg-0">
                                                <div class="row mb-4">
                                                    <label for="horizontal-email-input" class="col-sm-3 col-form-label">Addressline 1</label>
                                                    <div class="form-group col-sm-9">
                                                        <input type="text" class="form-control" id="address_1" name="address_1" value="{{usr_addr.address_1}}" >
                                                    </div>
                                                </div>
                                                <div class="row mb-4">
                                                    <label for="horizontal-email-input" class="col-sm-3 col-form-label">Addressline 2</label>
                                                    <div class="form-group col-sm-9">
                                                        <input type="text" class="form-control" id="address_2" name="address_2" value="{{usr_addr.address_2}}">
                                                    </div>
                                                </div>
                                                <div class="row mb-4">
                                                    <label for="horizontal-email-input" class="col-sm-3 col-form-label">City</label>
                                                    <div class="form-group col-sm-9">
                                                        <input type="text" class="form-control" id="city"  name="city" value="{{usr_addr.city}}">
                                                    </div>
                                                </div>
                                                <div class="row mb-4">
                                                    <label for="horizontal-email-input" class="col-sm-3 col-form-label">Country</label>
                                                    <div class="form-group col-sm-9">
                                                        <select name="country_id" id="country_id" class="form-control search-select" tabindex='4'>
                                                            <option value="">Select Country</option>
                                                            {% for cntrs in countries %}
                                                                <!-- <option>{{ cntrs.name|raw }}</option> -->
                                                                <option value="{{ cntrs.id }}" {% if usr_addr.country_id==cntrs.id %} selected {% endif %}>{{ cntrs.name|raw }}</option>
                                                                
                                                            {% endfor %}
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="row mb-4">
                                                    <label for="horizontal-email-input" class="col-sm-3 col-form-label">State</label>
                                                    <div class="form-group col-sm-9">
                                                        <span class="input-icon" id="state_span">
                                                            <select name="state" id="state_id" class="form-control search-select" tabindex='4'>
                                                                <option value="">{{ lang('select_a_state') }}</option>
                                                                    {% for sts in states %}
                                                                    <option value="{{ sts.id }}" {% if usr_addr.state_id==sts.id %} selected {% endif %}>{{ sts.name|raw }}</option>
                                                                    {% endfor %}
                                                            </select>
                                                        </span>
                                                    </div>
                                                </div> 

                                                <div class="row mb-4">
                                                    <label for="horizontal-email-input" class="col-sm-3 col-form-label">Zip code</label>
                                                    <div class="form-group col-sm-9">
                                                        <input type="text" class="form-control" id="zip_code"  name="zip_code" value="{{usr_addr.zip_code}}">
                                                    </div>
                                                </div>
                                                    <input type="hidden"  id="address_type" name="address_type">
                                                <div class="row mb-4">
                                                    <label class="form-label">Address Type (optional).</label>
                                                    <div>
                                                        <div class="form-group form-check-inline">
                                                            <input class="form-check-input" type="radio" name="address_type" id="address_type" value="Home"{% if usr_addr.address_type=='Home' %} checked {% endif %}>
                                                                <label class="form-check-label" for="flexRadioDefault1">
                                                                    Home
                                                                </label>
                                                        </div>
                                                        <div class="form-group form-check-inline">
                                                            <input class="form-check-input" type="radio" name="address_type" id="address_type" value="Office" {% if usr_addr.address_type=='Office' %} checked {% endif %}>
                                                                <label class="form-check-label" for="flexRadioDefault2">
                                                                    Office
                                                                </label>
                                                        </div>
                                                    </div>
                                                </div>
                                                    
                                                    <input type="hidden" id="status" name="status">
                                                <div class="row mb-4">
                                                    <div class="form-group form-check-right mb-3 ">
                                                        <input class="form-check-input" type="radio" name="status"  unchecked id="status" value="1" {% if usr_addr.status==1 %} checked {% endif %}>
                                                            <label class="form-check-label" for="flexRadioDefault1">
                                                                Default
                                                            </label>
                                                    </div>
                                                </div>
                                            </div> 
                                        </div>
                                    </div>
                                    <div class="row justify-content-end">
                                        <div class="col-sm-9">
                                            <div>
                                            {% if edit_flag %}
                                                <button type="submit" class="btn btn-primary" value="{{ add_id }}" name="update_address" id="update_address">
                                                    {{lang('update')}} <i class="fa fa-arrow-circle-right"></i>
                                                </button>
                                            {% else %}
                                                <button type="submit" class="btn btn-primary" value="add_address" name="add_address"> 
                                                    {{lang('submit')}} <i class="fa fa-arrow-circle-right"></i>
                                                </button>
                                            {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                {{form_close()|raw}}
                            </div>
                                    





                            <div class="tab-pane fade {% if active == 4 %} show active {% endif %} " id="v-pills-account" role="tabpanel" aria-labelledby="v-pills-account-tab" tabindex="0">
                                <!--account-details-->
                                <div class="card">
                                    <div class="card-header">
                                      <h3 class="mb-0">Account Details</h3>
                                      </div>
                                      <div class="card-body">
                                        {{ form_open('', 'class="account_details" id="account_details" name="account_details"')|raw }}
                                            <div class="mb-3">
                                                <label class="form-label">First Name <span class="required" title="required">*</span></label>
                                                <input type="text" name="first_name" value="{{ detail.first_name }}" class="form-control">
                                                  {% if login_error.first_name is defined %}<code> {{ login_error.first_name}} </code> {% endif %}
                                           
                                            </div>
                                             <div class="mb-3">
                                                <label class="form-label">Last Name <span class="required" title="required">*</span></label>
                                                <input type="text" name="last_name"  value="{{ detail.last_name }}" class="form-control">
                                                  {% if login_error.last_name is defined %}<code> {{ login_error.last_name}} </code> {% endif %}

                                            </div>
                                             <div class="mb-3">
                                                <label class="form-label">Email<span class="required" title="required">*</span></label>
                                                <input type="email" name="email"  value="{{ user_mail }}" class="form-control" readonly >
                                                  {% if login_error.email is defined %}<code> {{ login_error.email}} </code> {% endif %}

                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Mobile Number <span class="required" title="required">*</span></label>
                                                <input type="text" name="phone_number"  value="{{ detail.phone_number }}" class="form-control">
                                                  {% if login_error.phone_number is defined %}<code> {{ login_error.phone_number}} </code> {% endif %}

                                            </div>
                                            <button type="submit" name="account_details" value="account_details" class="btn btn-primary">Save Changes</button>
                                         {{form_close()|raw}}
                                      </div>
                                  </div>
                                         

                                <!--end account-details-->
                            </div>
                              <div class="tab-pane fade {% if active == 5 %} show active {% endif %} " id="v-pills-password" role="tabpanel" aria-labelledby="v-pills-password-tab" tabindex="0">
                                <!--account-details-->
                                <div class="card">
                                           
                                    <div class="card-header">
                                      <h3 class="mb-0">Change Password</h3>
                                      </div>
                                      <div class="card-body">
                                      {{ form_open('', 'class="password_details" id="password_details" name="password_details"')|raw }}

                                            <div class="mb-3">
                                                <label class="form-label">Current Password <span class="required" title="required">*</span></label>
                                                <input type="password" name="current_password" class="form-control">
                                                  {% if login_error.current_password is defined %}<code> {{ login_error.current_password}} </code> {% endif %}
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">New Password <span class="required" title="required">*</span></label>
                                                <input type="password" name="password" class="form-control">
                                                  {% if login_error.password is defined %}<code> {{ login_error.password}} </code> {% endif %}
                                            </div>
                                            <div class="mb-3">
                                                <label class="form-label">Confirm Password <span class="required" title="required">*</span></label>
                                                <input type="password" name="confirm_password" class="form-control">
                                                  {% if login_error.confirm_password is defined %}<code> {{ login_error.confirm_password}} </code> {% endif %}
                                            </div>
                                            <button type="submit"  name="change_password"  value="change_password" class="btn btn-primary">Save Changes</button>
                                    {{form_close()|raw}}
                                      </div>
                                  </div>
                                <!--end account-details-->
                            </div>
                          </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- END ACCOUNT -->


        <!-- FOOTER -->

           {% include('shop/layout/footer.twig')%}
        <!-- END FOOTER -->

    </div>

    <!-- All JS is here
============================================ -->

<!--     <script src="../assets/shop/js/vendor/modernizr-3.11.7.min.js"></script>
    <script src="assets/shop/js/vendor/jquery-v3.6.0.min.js"></script>
    <script src="assets/shop/js/vendor/jquery-migrate-v3.3.2.min.js"></script>
    <script src="assets/shop/js/vendor/popper.min.js"></script>
    <script src="assets/shop/js/vendor/bootstrap.min.js"></script>
    <script src="assets/shop/js/plugins/slick.js"></script>
    <script src="assets/shop/js/plugins/jquery.syotimer.min.js"></script>
    <script src="assets/shop/js/plugins/jquery.nice-select.min.js"></script>
    <script src="assets/shop/js/plugins/wow.js"></script>
    <script src="assets/shop/js/plugins/jquery-ui.js"></script>
    <script src="assets/shop/js/plugins/magnific-popup.js"></script>
    <script src="assets/shop/js/plugins/sticky-sidebar.js"></script>
    <script src="assets/shop/js/plugins/easyzoom.js"></script>
    <script src="assets/shop/js/plugins/scrollup.js"></script>
    <script src="assets/shop/js/plugins/ajax-mail.js"></script> -->
    <!-- Main JS -->
    <!-- <script src="assets/shop/js/main.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js" integrity="sha512-rstIgDs0xPgmG6RX1Aba4KV5cWJbAMcvRCVmglpam9SoHZiUCyQVDdH2LPlxoHtrv17XWblE/V/PP+Tr04hbtA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/js/toastr.min.js"></script>

    {# <script>
    function tabactive(tab_id){
        tab_id =tab_id;
    $.ajax({
        url: "shop/tab_actives",
        data: {tab_id: tab_id},
        success: function (result) {
            if (result == "yes") {
                console.log('active');
            }
        }

    });
};
    </script> #}

<script>
    var validate_address_form = function () {
        var form = $('#address_form');
        var errorHandler2 = $('.errorHandler', form);
        var successHandler2 = $('.successHandler', form);
        form.validate({
            errorElement: "div", // contain the error msg in a span tag
            errorClass: 'invalid-feedback',
            errorPlacement: function (error, element) { // render error placement for each input type
                
                error.appendTo($(element).closest('.form-group'));
            },
            ignore: ':hidden',
            rules: {
                address_1: {
                    required: true,
                },
                city: {
                    required: true,
                },
                country_id: {
                    required: true,
                },
                zip_code: {
                    required: true,
                    digits: true,
                },
                

            },
            messages: {
                address_1: {
                    required: $('#address_1_req_js').html()
                },
                city: {
                    required: $('#city_req_js').html()
                },
                country_id: {
                    required: $('#country_req_js').html()
                },
                zip_code: {
                    required: $('#zip_code_req_js').html()
                },

            },
            invalidHandler: function (event, validator) {
                successHandler2.hide();
                errorHandler2.show();
            },
            highlight: function (element) {
                $(element).closest('.form-control').removeClass('is-invalid');
                //display Checkbox invalid Data
                $(element).closest('.checkbox').removeClass('is-invalid').addClass('is-valid');
                // display OK icon
                $(element).closest('.form-control').removeClass('is-valid').addClass('is-invalid').find('.symbol').removeClass('ok').addClass('required');
                // add the Bootstrap error class to the control group
            },
            unhighlight: function (element) { // revert the change done by hightlight
                //display Checkbox invalid Data

                $(element).closest('.checkbox').removeClass('is-invalid').addClass('is-valid');
                $(element).closest('.form-control').removeClass('is-invalid').addClass('is-valid').find('.symbol').removeClass('ok').addClass('required');
                // set error class to the control group
            },
            success: function (label, element) {
                //display Checkbox invalid Data
                $(element).closest('.checkbox').removeClass('is-invalid').addClass('is-valid');
                $(element).closest('.form-control').removeClass('is-invalid').addClass('is-valid').find('.symbol').removeClass('ok').addClass('required');
                // mark the current input as valid and display OK icon
            },
            submitHandler: function (form) {
                successHandler2.show();
                errorHandler2.hide();
                form.submit();
                toastr.success('Success')
            }
        });
    };

</script>
<script>
    $(document).ready(function () {
        validate_address_form();
    });
</script>
<script>
    $('#country_id').on('change', function (e) {
    var optionSelected = $("option:selected", this);
    var valueSelected = this.value;

    $.ajax({url: "register/get_states",
        data: {country_id: valueSelected},
        async: false,
        success: function (msg) {
            $('#state_span').html(msg);
            $("#state").select2({
                placeholder: "Select a State",
                allowClear: false
            });
        }
    });

});

</script>
</body>

</html>