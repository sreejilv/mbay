{% include('admin/partials/head-main.twig')%}
<head>
    <base href="{{ base_url() }}" />
    <?= $title_meta ?>

    {% include('admin/partials/head-css.twig')%}
    <link href="assets/libs/flatpickr/flatpickr.min.css" rel="stylesheet" type="text/css">
    <!-- DataTables -->
    <link href="assets/libs/datatables.net-bs4/css/dataTables.bootstrap4.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/libs/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/libs/dropzone/min/dropzone.min.css" rel="stylesheet" type="text/css" />
    <!-- Responsive datatable examples -->
    <link href="assets/libs/datatables.net-responsive-bs4/css/responsive.bootstrap4.min.css" rel="stylesheet" type="text/css" />

    <link href="assets/libs/dropify/dropify.min.css" rel="stylesheet" type="text/css" />

</head>

<div id="js_messages" style="display: none;"> 
    <span id="company_name_req_js">{{lang('company_name_req_js')}}</span>   
    <span id="company_address_req_js">{{lang('company_address_req_js')}}</span>   
    <span id="company_email_req_js">{{lang('company_email_req_js')}}</span>
    <span id="valid_email_js">{{lang('valid_email_msg_js')}}</span>
    <span id="company_phone_req_js">{{lang('company_phone_req_js')}}</span>
    <span id="company_logo_req_js">{{lang('company_logo_req_js')}}</span>
    <span id="company_fav_icon_req_js">{{lang('company_fav_icon_req_js')}}</span>
    <span id="user_photo_ext_js">{{lang('user_photo_ext_js')}}</span>
    <span id="site_updated_complete">{{lang('site_updated_complete')}}</span>
    <span id="site_updated_failed">{{lang('site_updated_failed')}}</span>  
</div>

{% include('admin/partials/body.twig')%}
<!-- <body data-layout="horizontal"> -->

    <!-- Begin page -->
    <div id="layout-wrapper">

        {% include('admin/partials/menu.twig')%}
        <!-- ============================================================== -->
        <!-- Start right Content here -->
        <!-- ============================================================== -->
        <div class="main-content">

            <div class="page-content">
                {%include('admin/layout/notification.twig')%}
                <div class="container-fluid">

                    <!-- start page title -->
                    <?= $page_title ?>
                    <h4 class="panel-title">
                        <span class="text-bold">Site Settings </span>
                    </h4>
                    
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="card">
                                <div class="card-body">
                                    {{ form_open_multipart('', 'method="post" id="update_form1" name="update_form1"')|raw }}

                                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link active" id="edit-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">General</button>
                                        </li>
                                        <li class="nav-item" role="presentation">
                                            <button class="nav-link" id="address-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">Image</button>
                                        </li>
                                    </ul>
                                    <div class="tab-content" id="myTabContent">
                                        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                                            <div class="card-body p-4">
                                                <div class="row">
                                                    <div class="col-lg-12 ms-lg-auto">

                                                        <div class="mt-4 mt-lg-0">
                                                            <div class="row mb-4">
                                                                <label class="col-sm-2 col-form-label">Company Name<span class="text-danger"> *</span> </label>

                                                                <div class="col-sm-9">
                                                                    <input type="text" class="form-control" name="company_name" id="company_name" value="{{site_info.company_name}}">
                                                                    {% if login_error.company_name is defined %}<code> {{ login_error.company_name}} </code> {% endif %}

                                                                </div>
                                                            </div>

                                                            <div class="row mb-4">
                                                                <label class="col-sm-2 col-form-label">Address<span class="text-danger"> *</span> </label>
                                                                <div class="col-sm-9">
                                                                    <textarea class="form-control ckeditor" type="text" rows="4" cols="60" name="company_address" id="company_address" placeholder=''>{{site_info['company_address']}}</textarea>
                                                                    {% if login_error.company_address is defined %}<code> {{ login_error.company_address}} </code> {% endif %}
                                                                </div>
                                                            </div>

                                                            <div class="row mb-4">
                                                                <label class="col-sm-2 col-form-label">Company Email<span class="text-danger"> *</span> </label>
                                                                <div class="col-sm-9">
                                                                    <input type="text" class="form-control" name="company_email" id="company_email"  value="{{site_info.company_email}}">
                                                                    {% if login_error.company_email is defined %}<code> {{ login_error.company_email}} </code> {% endif %}

                                                                </div>
                                                            </div>

                                                            <div class="row mb-4">
                                                                <label class="col-sm-2 col-form-label">Company Phone Number<span class="text-danger"> *</span> </label>
                                                                <div class="col-sm-9">
                                                                    <input type="text" class="form-control"  name="company_phone" id="company_phone" value="{{site_info.company_phone}}">
                                                                    {% if login_error.company_phone is defined %}<code> {{ login_error.company_phone}} </code> {% endif %}

                                                                </div>
                                                            </div> 
                                                       <!--  <div class="row mb-4">
                                                            <label for="horizontal-firstname-input" class="col-sm-2 col-form-label">Google Analytics</label>
                                                            <div class="col-sm-9">
                                                                <input class="form-control" type="text" name="google_analytics" id="google_analytics" placeholder='{{lang('google_analytics')}}' value="{{site_info['google_analytics']}}">
                                                             {% if login_error.company_phone is defined %}<code> {{ login_error.company_phone}} </code> {% endif %}
                                                          
                                                            </div>
                                                        </div> -->
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="address-tab">

                                        <div class="card-body p-4"> 
                                            <div class="row">
                                                {# <div class="col-lg-12 ms-lg-auto"> #}
                                                    {# <div class="mt-4 mt-lg-0"> #}
                                                        <div class="col-lg-6">
                                                            <label>Company Logo<span class="text-danger"> *</span> </label>
                                                            <div class="dropify-wrapper mb-4 form-group col-lg-6">
                                                                <div class="dropify-errors-container">
                                                                    <ul></ul>
                                                                </div>
                                                                <input type="file" class="dropify" data-default-file="assets/images/{{site_info.company_logo}}" name="company_logo" id="company_logo" />
                                                                <button class="dropify-clear" type="button">Remove</button>
                                                                <span class="dropify-render"></span>
                                                                <p class="dropify-filename"><span class="file-icon"></span>
                                                                    <span class="dropify-filename-inner"></span></p>
                                                                    <p class="dropify-infos-message">Drag and drop or click to replace</p>
                                                                </div>
                                                            </div>

                                                            <div class="col-lg-6">
                                                                <label>Fav Icon<span class="text-danger"> *</span> </label>
                                                                <div class="dropify-wrapper mb-4 form-group col-lg-6">
                                                                    <div class="dropify-errors-container">
                                                                        <ul></ul>
                                                                    </div>
                                                                    <input type="file" class="dropify" data-default-file="assets/images/{{site_info.company_fav_icon}}" name="company_fav_icon" id="company_fav_icon" />
                                                                    <button class="dropify-clear" type="button">Remove</button>
                                                                    <span class="dropify-render"></span>
                                                                    <p class="dropify-filename"><span class="file-icon"></span>
                                                                        <span class="dropify-filename-inner"></span></p>
                                                                        <p class="dropify-infos-message">Drag and drop or click to replace</p>
                                                                    </div>
                                                                </div>
                                                            {# </div>  #}
                                                        {# </div> #}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row justify-content-end">
                                        <div class="">
                                            <div>
                                                  <button type="submit"class="btn btn-primary" value="update" name="update_site_info" id="update_site_info">
                                    {{lang('update')}} <i class="fa fa-arrow-circle-right"></i>
                                </button>  
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                </div>
                                {{form_close()|raw}}
                            </div>
                        </div> <!-- container-fluid -->
                        
                    </div>
                    <!-- End Page-content -->

                    {% include('admin/partials/footer.twig')%}
                </div>
                
                <!-- end main content-->
            </div>
        </div>
        <!-- END layout-wrapper -->


        {% include('admin/partials/right-sidebar.twig')%}
        <!-- JAVASCRIPT -->
        {% include('admin/partials/vendor-scripts.twig')%}
        <script src="assets/js/app.js"></script>
        <script src="assets/libs/flatpickr/flatpickr.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script src="assets/libs/dropify/dropify.min.js"></script>
        <!-- Required datatable js -->
        <script src="assets/libs/datatables.net/js/jquery.dataTables.min.js"></script>
        <script src="assets/libs/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
        <!-- Buttons examples -->
        <script src="assets/libs/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
        <script src="assets/libs/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
        <script src="assets/libs/jszip/jszip.min.js"></script>
        <script src="assets/libs/pdfmake/build/pdfmake.min.js"></script>
        <script src="assets/libs/pdfmake/build/vfs_fonts.js"></script>
        <script src="assets/libs/datatables.net-buttons/js/buttons.html5.min.js"></script>
        <script src="assets/libs/datatables.net-buttons/js/buttons.print.min.js"></script>
        <script src="assets/libs/datatables.net-buttons/js/buttons.colVis.min.js"></script>
        <!-- Responsive examples -->
        <script src="assets/libs/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
        <script src="assets/libs/datatables.net-responsive-bs4/js/responsive.bootstrap4.min.js"></script>
        <!-- pristine js -->

        {# <script src="assets/libs/pristinejs/pristine.min.js"></script> #}

        <!-- form validation -->

        {# <script src="assets/js/pages/form-validation.init.js"></script> #}

        <!-- Datatable init js -->
        <script src="assets/js/pages/datatables.init.js"></script>
        <!-- <script src="assets/js/file_extension.js"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.19.5/jquery.validate.min.js" integrity="sha512-rstIgDs0xPgmG6RX1Aba4KV5cWJbAMcvRCVmglpam9SoHZiUCyQVDdH2LPlxoHtrv17XWblE/V/PP+Tr04hbtA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
       <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.19.2/dist/additional-methods.js"></script>
        <script>

            var imgUpload = $('.dropify').dropify({
                imgFileExtensions: ["png", "jpg", "jpeg", "gif", "bmp","svg"]
            });

        </script>

        <script>
            $(document).ready(function () {
                validate_site_set();
            });
        </script>
     <script>
        var validate_site_set = function () {
            var form = $('#update_form1');
            var errorHandler1 = $('.errorHandler', form);
            var successHandler1 = $('.successHandler', form);
            form.validate({
            errorElement: "div", // contain the error msg in a span tag
            errorClass: 'invalid-feedback',
             errorPlacement: function (error, element) { // render error placement for 
                 if (element.attr("type") == "file" ) { 
                    error.insertAfter($(element).closest('.form-group').children('div').children().last());                     
                }else{
                    error.insertAfter(element);
                }
            },
            ignore: ':hidden',
            rules: {
                company_name: {
                    required: true,
                },
                company_address: {
                    required: true,
                },
                company_email: {
                    required: true,
                    email: true,
                },
                company_phone: {
                    required: true,
                    number: true,

                },
                company_logo: {
                    required: true
                },
                company_logo: {
                    required: true
                },
                company_fav_icon: {
                    required: true
                }
            },
            messages: {
                company_name: {
                    required: $('#company_name_req_js').html()
                },
                company_address: {
                    required: $('#company_address_req_js').html()
                },
                company_email: {
                    required: $('#company_email_req_js').html(),
                    email: $('#valid_email_js').html()
                },
                company_phone: {
                    required: $('#company_phone_req_js').html()
                },
                company_logo: {
                    required: $('#company_logo_req_js').html(),
                    extension: $('#user_photo_ext_js').html()
                },
                company_fav_icon: {
                    required: $('#company_fav_icon_req_js').html(),
                    extension: $('#user_photo_ext_js').html()
                }
            },
            invalidHandler: function(event, validator) { 

                successHandler1.hide();
                errorHandler1.show();
            },
            highlight: function(element) {
                $(element).closest('.form-control').removeClass('is-invalid');
                //display Checkbox invalid Data
                $(element).closest('.checkbox').removeClass('is-invalid').addClass('is-valid');
                // display OK icon
                $(element).closest('.form-control').removeClass('is-valid').addClass('is-invalid').find('.symbol').removeClass('ok').addClass('required');
                // add the Bootstrap error class to the control group
            },
            unhighlight: function(element) { // revert the change done by hightlight
                //display Checkbox invalid Data

                $(element).closest('.checkbox').removeClass('is-invalid').addClass('is-valid');
                $(element).closest('.form-control').removeClass('is-invalid').addClass('is-valid').find('.symbol').removeClass('ok').addClass('required');
                // set error class to the control group
            },
            success: function(label, element) {
                //display Checkbox invalid Data
                $(element).closest('.checkbox').removeClass('is-invalid').addClass('is-valid');
                $(element).closest('.form-control').removeClass('is-invalid').addClass('is-valid').find('.symbol').removeClass('ok').addClass('required');
                // mark the current input as valid and display OK icon
            },
            submitHandler: function(form) {
                successHandler1.show();
                errorHandler1.hide();
                form.submit();
            }
        });
            
        };

    </script>
    <style>
        .file-icon{
            display: none;
        }
    </style>
</body>

</html>